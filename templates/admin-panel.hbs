<div class="fax-bank-admin">
  {{! Header }}
  <header class="admin-header">
    <h2>üè¶ FAX-BANK Administration</h2>
    <p class="system-info">
      Game System: <strong>{{gameSystem}}</strong>
      {{#if isSupported}}
        <span class="supported">‚úÖ Full Support</span>
      {{else}}
        <span class="unsupported">‚ö†Ô∏è Custom Economy Mode</span>
      {{/if}}
    </p>
  </header>

  {{! Tab Navigation }}
  <nav class="admin-tabs">
    <button type="button" class="tab-btn {{#if (eq activeTab 'economies')}}active{{/if}}" data-tab="economies">
      üèõÔ∏è Economies
    </button>
    <button type="button" class="tab-btn {{#if (eq activeTab 'banks')}}active{{/if}}" data-tab="banks">
      üè¶ Banks
    </button>
    <button type="button" class="tab-btn {{#if (eq activeTab 'help')}}active{{/if}}" data-tab="help">
      ‚ÑπÔ∏è Help
    </button>
  </nav>

  {{! Tab Content }}
  <div class="admin-content">
    
    {{! Economies Tab }}
    {{#if (eq activeTab 'economies')}}
    <section class="tab-panel economies-panel">
      <h3>Create Economy</h3>
      <p class="hint">Economies represent kingdoms, factions, or regions with their own currency systems.</p>
      
      <div class="create-form">
        <div class="form-row">
          <label>Economy Name:</label>
          <input type="text" id="economy-name" placeholder="e.g., Kingdom of Valdris" />
        </div>
        <div class="form-row">
          <label>Description:</label>
          <input type="text" id="economy-description" placeholder="e.g., The northern kingdom" />
        </div>
        <div class="form-group">
          <h4>Base Currency</h4>
          <div class="form-row inline">
            <input type="text" id="base-currency-name" placeholder="Name (Gold)" />
            <input type="text" id="base-currency-abbrev" placeholder="Abbrev (gp)" />
            <input type="text" id="base-currency-symbol" placeholder="Symbol (ü™ô)" />
          </div>
        </div>
        <button type="button" id="create-economy-btn" class="primary-btn">
          <i class="fas fa-plus"></i> Create Economy
        </button>
      </div>

      <h3>Existing Economies</h3>
      {{#if economies.length}}
        <ul class="economy-list">
          {{#each economies}}
            <li class="economy-item" data-economy-id="{{this.id}}">
              <div class="economy-header">
                <strong>{{this.name}}</strong>
                <span class="economy-desc">{{this.description}}</span>
                <button type="button" class="delete-economy-btn danger-btn" data-economy-id="{{this.id}}">
                  <i class="fas fa-trash"></i>
                </button>
              </div>
              
              <div class="currencies">
                <h5>Currencies:</h5>
                <ul class="currency-list">
                  {{#each this.currencies}}
                    <li class="currency-item">
                      <span class="currency-symbol">{{this.symbol}}</span>
                      <span class="currency-name">{{this.name}} ({{this.abbrev}})</span>
                      <span class="currency-rate">1 base = {{this.baseValue}}</span>
                      {{#unless this.isBase}}
                        <button type="button" class="remove-currency-btn mini-btn" 
                                data-economy-id="{{../id}}" data-currency-id="{{this.id}}">
                          <i class="fas fa-times"></i>
                        </button>
                      {{/unless}}
                      {{#if this.isBase}}<span class="base-badge">BASE</span>{{/if}}
                    </li>
                  {{/each}}
                </ul>
                
                <div class="add-currency-form">
                  <input type="text" class="new-currency-name" placeholder="Name" />
                  <input type="text" class="new-currency-abbrev" placeholder="Abbrev" />
                  <input type="text" class="new-currency-symbol" placeholder="Symbol" />
                  <input type="number" class="new-currency-value" placeholder="Base Value" step="0.01" min="0.01" />
                  <button type="button" class="add-currency-btn mini-btn" data-economy-id="{{this.id}}">
                    <i class="fas fa-plus"></i> Add
                  </button>
                </div>
              </div>
            </li>
          {{/each}}
        </ul>
      {{else}}
        <p class="empty-state">No economies created yet. Create one above!</p>
      {{/if}}
    </section>
    {{/if}}

    {{! Banks Tab }}
    {{#if (eq activeTab 'banks')}}
    <section class="tab-panel banks-panel">
      <h3>Create Bank</h3>
      <p class="hint">Banks belong to economies. Assign an NPC actor to let players interact with the bank.</p>
      
      <div class="create-form">
        <div class="form-row">
          <label>Bank Name:</label>
          <input type="text" id="bank-name" placeholder="e.g., Royal Treasury" />
        </div>
        <div class="form-row">
          <label>Economy:</label>
          <select id="bank-economy">
            <option value="">-- Select Economy --</option>
            {{#each economies}}
              <option value="{{this.id}}">{{this.name}}</option>
            {{/each}}
          </select>
        </div>
        <div class="form-row">
          <label>Bank NPC (optional):</label>
          <select id="bank-npc">
            <option value="">-- No NPC --</option>
            {{#each availableActors}}
              <option value="{{this.id}}">{{this.name}} ({{this.type}})</option>
            {{/each}}
          </select>
        </div>
        <button type="button" id="create-bank-btn" class="primary-btn">
          <i class="fas fa-plus"></i> Create Bank
        </button>
      </div>

      <h3>Existing Banks</h3>
      {{#if banks.length}}
        <ul class="bank-list">
          {{#each banks}}
            <li class="bank-item" data-bank-id="{{this.id}}">
              <div class="bank-header">
                <strong>{{this.name}}</strong>
                <span class="bank-economy">Economy: {{this.economyId}}</span>
                <button type="button" class="delete-bank-btn danger-btn" data-bank-id="{{this.id}}">
                  <i class="fas fa-trash"></i>
                </button>
              </div>
              
              <div class="bank-npc-row">
                <label>Assigned NPC:</label>
                <select class="bank-npc-select">
                  <option value="">-- No NPC --</option>
                  {{#each ../availableActors}}
                    <option value="{{this.id}}" {{#if (eq this.id ../npcActorId)}}selected{{/if}}>
                      {{this.name}}
                    </option>
                  {{/each}}
                </select>
                <button type="button" class="assign-npc-btn mini-btn" data-bank-id="{{this.id}}">
                  <i class="fas fa-save"></i> Save
                </button>
              </div>
            </li>
          {{/each}}
        </ul>
      {{else}}
        <p class="empty-state">No banks created yet. Create an economy first, then add banks!</p>
      {{/if}}
    </section>
    {{/if}}

    {{! Help Tab }}
    {{#if (eq activeTab 'help')}}
    <section class="tab-panel help-panel">
      <h3>How FAX-BANK Works</h3>
      
      <div class="help-section">
        <h4>üèõÔ∏è Economies</h4>
        <p>Economies represent different monetary systems (kingdoms, factions, etc.). Each economy has its own currencies with exchange rates.</p>
      </div>
      
      <div class="help-section">
        <h4>üí∞ Currencies</h4>
        <p>Each economy has a base currency (value = 1). Additional currencies have exchange rates relative to the base.</p>
        <p>Example: If Gold is base (1) and Silver is 0.1, then 10 Silver = 1 Gold.</p>
      </div>
      
      <div class="help-section">
        <h4>üè¶ Banks</h4>
        <p>Banks belong to economies and hold player accounts. Players can deposit, withdraw, and transfer funds.</p>
      </div>
      
      <div class="help-section">
        <h4>üë§ Bank NPCs</h4>
        <p>Assign an actor (NPC) to a bank. When players open that NPC's sheet, they'll see a button to access the bank.</p>
      </div>
      
      <div class="help-section">
        <h4>üîó Character Sheet Integration</h4>
        {{#if isSupported}}
          <p>‚úÖ Your system ({{gameSystem}}) is supported! Deposits/withdrawals will update the character sheet currency.</p>
        {{else}}
          <p>‚ö†Ô∏è Your system uses custom economy tracking. Currency won't sync with character sheets automatically.</p>
        {{/if}}
      </div>
      
      <div class="help-section">
        <h4>üìú Console Commands</h4>
        <code>FAXBANK.openAdmin()</code> - Open this panel<br>
        <code>FAXBANK.openBank(actorId)</code> - Open bank for an actor
      </div>
    </section>
    {{/if}}
  </div>

  {{! Footer }}
  <footer class="admin-footer">
    <button type="button" class="refresh-btn">
      <i class="fas fa-sync"></i> Refresh
    </button>
  </footer>
</div>
